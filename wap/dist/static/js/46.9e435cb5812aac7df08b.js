webpackJsonp([46],{"4YJ3":function(e,t){},OnKA:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("pFYg"),o=a.n(r),n=a("Xxa5"),s=a.n(n),d=a("mvHQ"),l=a.n(d),c=a("exGp"),i=a.n(c),u=a("Dd8w"),f=a.n(u),m=a("//Fk"),p=a.n(m),v=a("FWz8"),g=a("1CjK"),h=a("3r8y"),y=a("Gtft"),b=a("N6PA"),x=a("6D10"),I=a("OT9B"),k={name:"order-add-three",extends:h.a,created:function(){var e=this;this.$nextTick(function(){e.params=e.$route.params,e.params&&e.params.oldData&&e.params.oldData.clueId&&(e.clueId=e.params.oldData.clueId),e.params&&e.params.clueInfo&&e.params.clueInfo.id&&(e.clueId=e.params.clueInfo.id),console.log(e.params,"-----------\x3e0203");var t=e.params;t&&t.id?(e.id=t.id,e.form.type="edit"):e.form.type="add","add"===e.form.type?e.getPage({}):e.params.oldData&&e.getPage(e.params.oldData)})},activated:function(){y.a.setRight(),this.params.id?y.a.setTitle({title:"编辑合同"}):y.a.setTitle({title:"业务信息"})},data:function(){return{initData:null,clueId:"",id:"",form:{type:"add",info:[{attr:"name",type:"text",title:"客户名称",text:null,placeholder:"请选择客户名称1",rules:{required:!0},required:!1,indent:!1,disable:!0},{attr:"mobile",type:"text",title:"联系电话",text:null,placeholder:"客户联系电话",rules:{required:!0},required:!1,indent:!1,disable:!0},{attr:"gender",type:"text",title:"性别",text:null,placeholder:"请选择性别",rules:{required:!0},required:!1,indent:!1,disable:!0}],data:[]},params:{},stores:{}}},methods:{isEdit:function(){return this.$store.dispatch("order/getData2",this.form.data),!1},onBtnClick:function(){var e=this;console.log("新建订单2");var t=[];this.$refs.va.forEach(function(e){e.rules&&!Object(x.j)(e)&&t.push(e.changeV())}),p.a.all(t).then(function(t){console.log("新建线索2",e.$refs.va);var a=t.every(function(e){return e});console.log(a),a&&(console.log(e.form,"校验成功并提交数据"),e.form.data.forEach(function(t){"orderType"===t.attr&&e.$store.dispatch("order/getOrderType",t.value)}),e.$RouteUtil.orderAddFour(f()({},e.params,{storeId:e.$store.state.order.storeId,storeAddress:e.$store.state.order.storeAddress,data2:e.form.data})))})},onGetMan:function(e,t){var a=this;return i()(s.a.mark(function r(){var o;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=7;break}return r.next=3,Object(v.q)(e);case 3:o=r.sent,console.log(o,"res111"),a.form.data.forEach(function(e,t){"belongStoreId"===e.attr&&(a.stores={},o.stores.map(function(e){return a.stores[e.id]=e.no,!1}),a.form.data[t].selData={source:o.stores.map(function(e,t){return{key:e.name,value:{id:e.id,areas:o.areas[t],stores:o.stores[t]}}})})}),t&&(a.initData=l()(a.form));case 7:case"end":return r.stop()}},r,a)}))()},onStore:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){console.log(void 0===e?"undefined":o()(e),"==>000"),"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof e&&(e=JSON.parse(e)),console.log(void 0===e?"undefined":o()(e),"==>000==>000");var r=!0,n=-1;this.form.data.forEach(function(e){if("orderType"===e.attr){var a=t.$ChangeType.xToType(e.value,"string");n=a}}),["3","4","5","6","7"].indexOf(n)>-1&&(r=!1),this.form.data.forEach(function(o,n){"storeAddress"===o.attr&&(r&&t.$store.dispatch("order/getStoreAddress",e.stores.address),r&&t.$store.dispatch("order/getStoreId",e.stores.id),a||(console.log(e,"==>666"),t.form.data[n].text=e.stores.address,t.form.data[n].value=e.stores.address)),"belongPlaceId"===o.attr&&(a||(t.form.data[n].text=e.areas.address,t.form.data[n].value=e.areas.codes&&""+e.areas.codes[e.areas.codes.length-1]))})}},onSelect:function(e,t){var a=this;return i()(s.a.mark(function r(){var o,n,d;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log(e,"==>orderType"),e.value=a.$ChangeType.xToType(e.value,"string"),"orderType"!==e.type||"0"!==e.value&&"1"!==e.value&&"3"!==e.value||a.params.clueInfo&&Object(I.l)({clueId:a.params.clueInfo.id}).then(function(e){1005010017!==e.code&&1005010018!==e.code&&1005010019!==e.code||(console.log(e,"==>res123"),a.$AlertUtil.showToast({txt:e.message,type:"error"}),a.form.data.forEach(function(e,t){"orderType"===e.attr&&(a.form.data[t].text=null,a.form.data[t].value=null)}))}),"orderType"!==e.type){r.next=15;break}return r.next=6,Object(v.n)({clueId:a.clueId||"",orderType:e.value});case 6:o=r.sent,console.log("==>orderSource",o),a.form.data.forEach(function(e,r){if("orderSource"===e.attr){var n=!0;t||(o.forEach(function(e){e.code===a.form.data[r].value&&(n=!1)}),n&&(a.form.data[r].text=null,a.form.data[r].value=null)),a.form.data[r].selData={source:JSON.parse(l()(o.map(function(e){return{key:e.name,value:e.code}})))}}}),n=a.menu.orderSource,console.log("==>",n),"0"===e.value&&(a.params.clueInfo&&a.params.clueInfo.groundPromotionId?a.form.data.forEach(function(e,t){"orderSource"===e.attr&&(a.form.data[t].disable=!0,a.form.data[t].text=n[2].name,a.form.data[t].value=n[2].code)}):a.params.clueInfo&&a.params.clueInfo.brokerId?a.form.data.forEach(function(e,t){"orderSource"===e.attr&&(a.form.data[t].disable=!0,a.form.data[t].text=n[1].name,a.form.data[t].value=n[1].code)}):a.form.data.forEach(function(e,t){"orderSource"===e.attr&&(a.form.data[t].disable=!1)})),["3","4","5","6","7"].indexOf(e.value)>-1?a.form.data.forEach(function(e,r){"belongStoreId"===e.attr&&(t||(a.form.data[r].text=null,a.form.data[r].value=null),a.form.data[r].disable=!0,a.form.data[r].hide=!0,a.form.data[r].rules.required=!1,a.$store.dispatch("order/getStoreId","")),"storeAddress"===e.attr&&(t||(a.form.data[r].text=null,a.form.data[r].value=null,a.form.data[r].hide=!0),a.$store.dispatch("order/getStoreAddress","")),"belongPlaceId"===e.attr&&(a.form.data[r].disable=!1,a.form.data[r].type="address",a.form.data[r].addressType=!0)}):(d=!1,a.form.data.forEach(function(e,r){"belongStoreId"===e.attr&&(a.form.data[r].disable=!1,a.form.data[r].hide=!1,a.form.data[r].rules.required=!0),"storeAddress"===e.attr&&(a.form.data[r].hide=!1,a.form.data[r].value||(d=!0)),"belongPlaceId"===e.attr&&(a.form.data[r].addressType=!0,a.form.data[r].disable=!0,a.form.data[r].type="text",d&&!t&&(a.form.data[r].text=null,a.form.data[r].value=null))})),r.next=15;break;case 15:case"end":return r.stop()}},r,a)}))()},onCarModel:function(e){console.log(e,"2233344")},getPage:function(e){var t=this;console.log(e);var a=this.menu,r=a.clueAdditionalConfiguration,n=a.clueIntentionType,s=a.clueShoppingWay,d=a.gender,c=a.customerOrigin,i=a.customerType,u=a.orderType,f=a.orderSource;console.log(a.orderType,"OrderType"),console.log(a.orderSource,"OrderSource"),this.$store.state.order.data2?this.form.data=this.$store.state.order.data2:Object(v.g)().then(function(a){console.log(a,"=========================>success2");var m=[];a.forEach(function(e){console.log(e),"create-order"===e.code&&"add"===t.form.type?m=e.fields:"edit-order"===e.code&&"edit"===t.form.type&&(m=e.fields)}),m.sort(function(e,t){return e.sort-t.sort}),t.allData=m,console.log(m,"=========================>data2");var p=m.filter(function(e){return"step2"===e.description}),h=[];p.forEach(function(a){var m={attr:a.attr,type:g.a[a.configsObj.type],title:a.name,text:null,value:null,placeholder:a.configsObj.placeholder,indent:!0,columnWidth:a.columnWidth,selData:{source:[],selectedKey:"无"}};if("receiptsNo"===m.attr&&(m.disable=!0,Object(v.m)().then(function(e){console.log(e,"==>getOrderNo"),m.text=e,m.value=e})),"storeAddress"===m.attr&&(m.disable=!0,a.rulesObj=null),"responsibleId"===m.attr&&(console.log(t.$store.state.user.users),m.selData={source:t.$store.state.user.users.map(function(e){return{key:e.name,value:e.dingUserId}})}),"belongPlaceId"===m.attr&&(m.disable=!0),"edit"===t.form.type){m.value=e[m.attr],m.text=e[m.attr];try{"orderType"===m.attr&&(m.text=e[m.attr].name,m.value=e[m.attr].code,m.disable=!0,t.onSelect({type:"orderType",value:m.value},!0)),"orderSource"===m.attr&&(m.text=e[m.attr].name,m.value=e[m.attr].code),"responsibleId"===m.attr&&(m.text=e.responsible.name,m.value=e.responsible.id,m.value&&t.onGetMan(e.responsible.dingUserId,!0)),"belongStoreId"===m.attr&&(m.text=e.groundStoreDTO.storeName,m.value=e.groundStoreDTO,m.selData.selectedKey="object"===o()(m.value)&&l()(p.value),t.$store.dispatch("order/getStoreAddress",m.text),t.$store.dispatch("order/getStoreId",e.groundStoreDTO.id),t.onStore(m.value,!0)),"storeAddress"===m.attr&&(m.text=e.storeAddress,m.value=e.storeAddress),"belongPlaceId"===m.attr&&(m.text=e.area&&e.area.name||"",m.value=e.area&&e.area.id||"")}catch(e){console.log(e)}}var y=!1;a.rulesObj&&a.rulesObj.forEach(function(e){"required"===e.type&&(y=!0)});var x=Object(b.a)(a);switch(y&&(m.required=y),x&&(m.rules=x),a.attr){case"vehicleModelId":m.selData={source:r.map(function(e){return{key:e.name,value:e.code}})};break;case"intentionType":case"intentionGrade":m.selData={source:n.map(function(e){return{key:e.name,value:e.code}})};break;case"shoppingWay":m.selData={source:s.map(function(e){return{key:e.name,value:e.code}})};break;case"appearance":case"interior":m.selData=null;break;case"gender":m.selData={source:d.map(function(e){return{key:e.name,value:e.code}})};break;case"origin":m.selData={source:c.map(function(e){return{key:e.name,value:e.code}})};break;case"type":m.selData={source:i.map(function(e){return{key:e.name,value:e.code}})};break;case"orderType":m.selData={source:u&&u.map(function(e){return{key:e.name,value:e.code}})};break;case"orderSource":m.selData={source:f&&f.map(function(e){return{key:e.name,value:e.code}})}}h.push(m)}),t.form.data=h,console.log(t.form.data,"----------\x3e>>>>>>>>>"),t.initData=l()(t.form)}).catch(function(e){console.log(e,"==============================>err")})}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"input-box2"},[a("cube-scroll",[a("div",{staticClass:"content"},[e._l(e.form.data,function(t,r){return["customerId"===t.attr?a("div",{key:"index"+r,staticClass:"id-box"},e._l(e.form.info,function(t,r){return a("div",{key:"index2"+r,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:"info",refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth,disable:!0},on:{"update:value":function(a){e.$set(t,"value",a)}},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item1.text"}},"yi-input",t,!1))],1)})):"groupHeader"===t.type?a("div",{key:"index"+r,staticClass:"section-title section-margin-top"},[e._v("\n            "+e._s(t.title)+"\n          ")]):a("div",{key:"index"+r,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:"va",refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth},on:{"update:value":function(a){e.$set(t,"value",a)},"update:selData":function(a){e.$set(t,"selData || null",a)},onCarModel:e.onCarModel,onGetMan:e.onGetMan,onStore:e.onStore,onSelect:e.onSelect},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}},"yi-input",t,!1))],1)]}),e._v(" "),a("div",{staticClass:"space-box"})],2)])],1),e._v(" "),a("yi-btn-box",{attrs:{name:"下一步"},on:{onBtnClick:e.onBtnClick}})],1)},staticRenderFns:[]};var D=a("VU/8")(k,S,!1,function(e){a("4YJ3")},"data-v-76bda7b3",null);t.default=D.exports}});
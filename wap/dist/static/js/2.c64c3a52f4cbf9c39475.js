webpackJsonp([2],{Jbov:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Xxa5"),r=a.n(o),n=a("exGp"),c=a.n(n),s=a("Dd8w"),l=a.n(s),i=a("pFYg"),u=a.n(i),m=a("//Fk"),d=a.n(m),f=a("mvHQ"),v=a.n(f),p=a("rMyF"),g=a("1CjK"),h=a("3r8y"),b=a("Gtft"),y=a("N6PA"),k=a("D2Ra"),x=a("6D10"),j={name:"client-add",extends:h.a,created:function(){var e=this;this.$nextTick(function(){e.params=e.$route.params;var t=e.params;t&&t.id?(e.id=t.id,e.form.type="edit"):e.form.type="add","add"===e.form.type?e.getPage({}):Object(p.h)(e.id).then(function(t){e.getPage(t)}).catch(function(e){console.log(e)})})},activated:function(){b.a.setRight()},data:function(){return{initData:null,more:!1,form:{type:"add",data:[],more:{data:[]}}}},computed:{form2:function(){var e=this.form;return e.more&&e.more.data?e.more.data:null}},methods:{isEdit:function(){return this.initData!==v()(this.form)},onBtnClick:function(){var e=this,t=[];console.log("---------------------========================"),console.log(this.$refs.va),this.$refs.va.forEach(function(e){e.rules&&!Object(x.j)(e)&&t.push(e.changeV())}),console.log(t,"--------"),d.a.all(t).then(function(t){if(t.every(function(e){return e})){console.log(e.form,"校验成功并提交数据");var a={};for(var o in e.form.data.forEach(function(e){var t="";t=e.value?e.value:0===e.value?0:e.text,a[e.attr]=t}),e.form.more.data.forEach(function(e){var t="";t=e.value?e.value:0===e.value?0:e.text,a[e.attr]=t}),console.log(a),a){switch(o){case"gender":a[o]=parseInt(a[o]);break;case"area":a[o]=""+a[o];break;case"origin":case"type":a[o]=parseInt(a[o])}console.log(u()(a[o]),a[o])}"add"===e.form.type?Object(p.b)(a).then(function(t){e.$RouteUtil.clientAddSuccess(l()({},e.params,{name:t.name,customerNo:t.customerNo,id:t.id})),e.params.onSuccess&&e.params.onSuccess(),console.log(t,"--------01---------")}).catch(function(e){console.log(e,"--------02---------")}):"edit"===e.form.type&&(a.id=e.id,console.log(a,"items"),Object(p.d)(a).then(function(t){console.log(t,""),e.params.onSuccess&&e.params.onSuccess(),e.$router.go(-1)}).catch(function(e){return console.log(e)}))}})},onGetName:function(e){var t=this;console.log("--------------555555"),console.log(e),console.log(this.form),this.form.data.forEach(function(a,o){console.log(a),"name"===a.attr&&(t.form.data[o].value=e,t.form.data[o].text=e)})},onMoreClick:function(){var e=!this.more;this.more=e,console.log(this.form.data[6].line),this.form.data[this.form.data.length-1].line=!e},getPage:function(e){var t=this;return c()(r.a.mark(function a(){var o,n,c,s,l,i,u,m,d,f,h;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(e),o=t.menu,n=o.followUpTarget,c=[],s=o.clueAdditionalConfiguration,l={selKey:1,colorList:[{name:"无",colors:{size:1,color:["",""]}}]},i={selKey:1,colorList:[{name:"无",colors:{size:1,color:["",""]}}]},u=o.clueIntentionType,m=o.clueShoppingWay,d=o.gender,f=o.customerType,a.next=13,Object(k.b)();case 13:h=a.sent,Object(p.f)().then(function(a){console.log(a,"=========================>success");var o=[];a.forEach(function(e){"create-customers"===e.code&&"add"===t.form.type&&(o=e.fields),"edit-customers"===e.code&&"edit"===t.form.type&&(o=e.fields)}),o.sort(function(e,t){return e.sort-t.sort}),console.log(o,"=========================>data");var r=[],p=[],b=0;o.forEach(function(t,a){t.rulesObj&&t.rulesObj[0]&&t.rulesObj[0].type&&b++;var o={attr:t.attr,type:g.a[t.configsObj.type],title:t.name,text:null,value:null,placeholder:t.configsObj.placeholder,indent:!0,selData:{source:[{key:"下单客户1",value:1},{key:"下单客户2",value:2}],selectedKey:"下单客户1"}};e[o.attr]&&(o.text=e[o.attr],o.value=e[o.attr],"gender"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"responsible"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].dingUserId),"origin"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"type"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"level"===o.attr&&(o.text=e[o.attr].code,o.value=e[o.attr].code),"industry"===o.attr&&(o.text=e[o.attr]),"area"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"address"===o.attr&&(o.text=Object(x.d)(e[o.attr]),o.value=Object(x.d)(e[o.attr])),"remark"===o.attr&&(o.text=Object(x.d)(e[o.attr]),o.value=Object(x.d)(e[o.attr])));var v=!1;t.rulesObj&&t.rulesObj.forEach(function(e){"required"===e.type&&(v=!0)});var k=Object(y.a)(t);switch(v&&(o.required=v),k&&(o.rules=k),t.attr){case"target":o.selData.source=n.map(function(e){return{key:e.name,value:e.code}});break;case"purpose":o.selData.source=c;break;case"vehicleModelId":o.selData.source=s.map(function(e){return{key:e.name,value:e.code}});break;case"intentionType":case"intentionGrade":o.selData.source=u.map(function(e){return{key:e.name,value:e.code}});break;case"shoppingWay":o.selData.source=m.map(function(e){return{key:e.name,value:e.code}});break;case"appearance":o.selData=l;break;case"interior":o.selData=i;break;case"gender":o.selData.source=d.map(function(e){return{key:e.name,value:e.code}});break;case"origin":o.selData.source=h.map(function(e){return{key:e.name,value:e.code}});break;case"type":o.selData.source=f.map(function(e){return{key:e.name,value:e.code}})}a<b?r.push(o):p.push(o)}),t.form.data=r,t.form.more.data=p,console.log(t.form.data,"----------\x3e>>>>>>>>>"),t.initData=v()(t.form)}).catch(function(e){console.log(e,"==============================>err")});case 15:case"end":return a.stop()}},a,t)}))()}}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container app-init"},[a("div",{staticClass:"input-box2"},[a("cube-scroll",[e._l(e.form.data,function(t,o){return[a("yi-input",e._b({key:o,ref:"va",refInFor:!0,attrs:{value:t.value,selData:t.selData||null},on:{"update:value":function(a){e.$set(t,"value",a)},onGetName:e.onGetName},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}},"yi-input",t,!1))]}),e._v(" "),[a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.more&&e.more,expression:"form.more && more"}],staticClass:"more-box"},[e._l(e.form2,function(t,o){return[a("yi-input",e._b({key:o,ref:t.rules.required?"va1":null,refInFor:!0,attrs:{value:t.value,selData:t.selData||null},on:{"update:value":function(a){e.$set(t,"value",a)}},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}},"yi-input",t,!1))]})],2)],e._v(" "),e.form2?a("yi-touch",{staticClass:"p-more",attrs:{"component-name":"p"},on:{click:e.onMoreClick}},[e._v("\n        "+e._s(e.more?"收起更多资料":"完善更多资料")+"\n        "),e.more?a("img",{staticClass:"ico-more",attrs:{src:e.$images.follow.angle_top,alt:"img"}}):a("img",{staticClass:"ico-more",attrs:{src:e.$images.follow.angle_bottom,alt:"img"}})]):e._e()],2)],1),e._v(" "),a("yi-btn-box",{attrs:{name:"确认提交"},on:{onBtnClick:e.onBtnClick}})],1)},staticRenderFns:[]};var O=a("VU/8")(j,D,!1,function(e){a("XNLk")},"data-v-ed70d4ee",null);t.default=O.exports},XNLk:function(e,t){}});
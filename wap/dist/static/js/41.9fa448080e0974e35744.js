webpackJsonp([41],{"0tAy":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("pFYg"),n=a.n(o),r=a("mvHQ"),s=a.n(r),l=a("Dd8w"),c=a.n(l),i=a("//Fk"),u=a.n(i),d=a("ViqS"),f=a.n(d),p=a("FWz8"),m=a("1CjK"),v=a("3r8y"),y=a("Gtft"),g=a("N6PA"),h=a("6D10"),x={name:"order-add-four",extends:v.a,created:function(){var e=this;this.$nextTick(function(){e.params=e.$route.params,console.log(e.params,"-----------\x3e0203");var t=e.params;t&&t.id?(e.id=t.id,e.form.type="edit"):e.form.type="add","add"===e.form.type?e.getPage({}):e.params.oldData&&e.getPage(e.params.oldData)})},activated:function(){y.a.setRight(),this.params.id?y.a.setTitle({title:"编辑合同"}):y.a.setTitle({title:"价款与数量"})},data:function(){return{initData:null,clueId:"",id:"",form:{type:"add",info:[{attr:"name",type:"text",title:"客户名称",text:null,placeholder:"请选择客户名称1",rules:{required:!0},required:!1,indent:!1,disable:!0},{attr:"mobile",type:"text",title:"联系电话",text:null,placeholder:"客户联系电话",rules:{required:!0},required:!1,indent:!1,disable:!0},{attr:"gender",type:"text",title:"性别",text:null,placeholder:"请选择性别",rules:{required:!0},required:!1,indent:!1,disable:!0}],data:[]},params:{},stores:{}}},methods:{isEdit:function(){return this.$store.dispatch("order/getData3",this.form.data),!1},onBtnClick:function(){var e=this;console.log("新建订单4");var t=[];this.$refs.va.forEach(function(e){e.rules&&!Object(h.j)(e)&&!1===e.hide&&t.push(e.changeV())}),u.a.all(t).then(function(t){console.log("新建线索2",e.$refs.va);var a=t.every(function(e){return e});if(console.log(a),a){console.log(e.form,"校验成功并提交数据");var o="",n="";e.form.data.forEach(function(t,a){if("belongStoreId"===t.attr){var r=t.value;"string"==typeof t.value&&(r=JSON.parse(t.value)),o=e.stores[r.id]}if("orderType"===t.attr){var s=JSON.parse(t.value);n=s.businessCode,e.form.data[a].value=s.code}}),console.log(e.params,"ddd"),console.log(e.stores),console.log(o),e.$RouteUtil.orderAdd(c()({},e.params,{belongStoreId:o,businessCode:n,data3:e.form.data}))}})},onGetMan:function(e,t){var a=this;console.log(e),e&&Object(p.q)(e).then(function(e){console.log(e);a.form.data.forEach(function(t,o){"belongStoreId"===t.attr&&(a.stores={},e.stores.map(function(e){return a.stores[e.id]=e.no,!1}),a.form.data[o].selData.source=e.stores.map(function(t,a){return{key:t.name,value:c()({id:t.id},e.areas[a])}}))}),a.form.data.forEach(function(e,t){"belongStoreId"!==e.attr&&"belongPlaceId"!==e.attr||(a.form.data[t].text="",a.form.data[t].value="")}),t&&(a.initData=s()(a.form))}).catch(function(e){return console.log(e)})},onStore:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&(console.log(void 0===e?"undefined":n()(e),"==>000"),"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof e&&(e=JSON.parse(e)),console.log(void 0===e?"undefined":n()(e),"==>000==>000"),this.form.data.forEach(function(o,n){"belongPlaceId"===o.attr&&(a||(console.log(e,"==>666"),console.log(t.form.data[n],"==>111"),console.log(t.form.data[n].attr,"==>222"),console.log(e.address,"==>333"),console.log(e.codes,"==>444"),console.log(e.codes[e.codes.length-1],"==>555"),t.form.data[n].text=e.address,t.form.data[n].value=e.codes&&""+e.codes[e.codes.length-1]))}))},onCarModel:function(e){console.log(e,"2233344")},getPage:function(e){var t=this,a=this.menu,o=a.clueAdditionalConfiguration,n=a.clueIntentionType,r=a.clueShoppingWay,l=a.gender,c=a.customerOrigin,i=a.orderSource,u=a.orderType,d=a.insuranceCompany,v=a.insuranceExpensesType,y=a.purchaseTaxType;try{v=v.filter(function(e){return"无"!==e.name}),y=y.filter(function(e){return"无"!==e.name})}catch(e){console.log(e)}if(console.log(u,"type--------------------"),this.$store.state.order.data3)this.form.data=this.$store.state.order.data3;else{Object(p.g)().then(function(a){console.log(a,"=========================>success2");var p=[];a.forEach(function(e){console.log(e),"create-order"===e.code&&"add"===t.form.type?p=e.fields:"edit-order"===e.code&&"edit"===t.form.type&&(p=e.fields)}),p.sort(function(e,t){return e.sort-t.sort}),t.allData=p,console.log(p,"=========================>data2");var x=p.filter(function(e){return"step3"===e.description}),b=[];x.forEach(function(t){var a={attr:t.attr,type:m.a[t.configsObj.type],title:t.name,text:null,value:null,placeholder:t.configsObj.placeholder,indent:!0,columnWidth:t.columnWidth,selData:{source:[{key:"无",value:"-1"}],selectedKey:"无"}};"money"===a.type&&(a.text=0,a.value=0),e[a.attr]&&(a.value=e[a.attr],a.text=e[a.attr],"money"===a.type&&(a.text=f()(e[a.attr]).format("0,0.00"),a.value=f()(e[a.attr]).format("0.00")),"insuranceExpensesType"===a.attr&&(a.text=e.insuranceExpensesType.name,a.value=e.insuranceExpensesType.code),"purchaseTaxType"===a.attr&&(a.text=e.purchaseTaxType.name,a.value=e.purchaseTaxType.code),"textarea"===a.type&&(a.text=Object(h.d)(e[a.attr]),a.value=Object(h.d)(e[a.attr])));var p=!1;t.rulesObj&&t.rulesObj.forEach(function(e){"required"===e.type&&(p=!0)});var x=Object(g.a)(t);switch(p&&(a.required=p),x&&(a.rules=x),t.attr){case"orderType":a.selData.source=u.map(function(e){return{key:e.name,value:s()(e)}});break;case"insuranceCompany":a.selData.source=d&&d.map(function(e){return{key:e.name,value:e.code}});break;case"vehicleModelId":a.selData.source=o.map(function(e){return{key:e.name,value:e.code}});break;case"intentionType":case"intentionGrade":a.selData.source=n.map(function(e){return{key:e.name,value:e.code}});break;case"shoppingWay":a.selData.source=r.map(function(e){return{key:e.name,value:e.code}});break;case"appearance":case"interior":a.selData=null;break;case"gender":a.selData.source=l.map(function(e){return{key:e.name,value:e.code}});break;case"origin":a.selData.source=c.map(function(e){return{key:e.name,value:e.code}});break;case"type":a.selData.source=customer.map(function(e){return{key:e.name,value:e.code}});break;case"orderSource":a.selData.source=i&&i.map(function(e){return{key:e.name,value:e.code}});break;case"insuranceExpensesType":a.selData.source=v&&v.map(function(e){return{key:e.name,value:e.code}});break;case"purchaseTaxType":a.selData.source=y&&y.map(function(e){return{key:e.name,value:e.code}})}"insuranceCompany"===a.attr&&(a.selData.source||(a.selData.source=[]),a.selData.source.push({key:"其他",value:"其他"})),b.push(a)}),t.form.data=b,console.log(t.form.data,"----------\x3e>>>>>>>>>"),t.initData=s()(t.form)}).catch(function(e){console.log(e,"==============================>err")});var x=this.$route.params;console.log(x,"22222"),this.params=x}}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"input-box2"},[a("cube-scroll",[a("div",{staticClass:"content"},[e._l(e.form.data,function(t,o){return["customerId"===t.attr?a("div",{key:"index"+o,staticClass:"id-box"},e._l(e.form.info,function(t,o){return a("div",{key:"index2"+o,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:"info",refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth,disable:!0},on:{"update:value":function(a){e.$set(t,"value",a)}},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item1.text"}},"yi-input",t,!1))],1)})):"groupHeader"===t.type?a("div",{key:"index"+o,staticClass:"section-title section-margin-top"},[e._v("\n            "+e._s(t.title)+"\n          ")]):a("div",{key:"index"+o,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:t.rules.required?"va":null,refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth},on:{"update:value":function(a){e.$set(t,"value",a)},onCarModel:e.onCarModel,onGetMan:e.onGetMan,onStore:e.onStore},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}},"yi-input",t,!1))],1)]}),e._v(" "),a("div",{staticClass:"space-box"})],2)])],1),e._v(" "),a("yi-btn-box",{attrs:{name:"下一步"},on:{onBtnClick:e.onBtnClick}})],1)},staticRenderFns:[]};var k=a("VU/8")(x,b,!1,function(e){a("PRZF")},"data-v-831e6238",null);t.default=k.exports},PRZF:function(e,t){}});
webpackJsonp([14],{"8MRZ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ssPP"),n=a("OPJW"),s=a("Gtft"),c=a("AYFL"),r=a("t5DY"),o=a("laDb"),l={name:"OfferDetail",extends:n.a,components:{QuotedRecordTab:i.a,ListBox:c.a},data:function(){return{data:null,showError:!1,showLoading:!0,errorMessage:"",params:this.$route.params}},computed:{infoValue:function(){if(this.showLoading)return[];var t=this.data,e=t.clueNo,a=t.enquiryNo,i=t.id,n=t.vehicleModel,s=t.clueId,c=t.appearance,r=t.interior,l=t.clueLevel,d=t.guidingPrice,u=t.customerType,m=t.otherDemand,h=t.number,v=t.billingTime,f=t.estimateObtainTime,p=t.billingDemand,y=t.shoppingWay,b=t.area;return[{title:"询价单号",value:a,click:function(){return o.a.commonDetail({id:i,module:"enquiryPrices"})}},{title:"线索编号",value:e,click:function(){return o.a.commonDetail({id:s,module:"clues"})}},{title:"车型信息",value:n},{title:"外观",value:c,type:"color"},{title:"内饰",value:r,type:"color"},{title:"等级",value:l&&l.name},{title:"指导价",value:1e4*d,type:"money"},{title:"购车方式",value:y&&y.name},{title:"客户类型",value:u&&u.name},{title:"上牌地区",value:b},{title:"预计提车时间",value:f},{title:"台数",value:h},{title:"开票价要求",value:p},{title:"开票时间要求",value:v},{title:"其他需求",value:m,type:"html"}]}},methods:{fetchData:function(){var t=this;Object(r.j)({id:"quotedRecords"===this.params.module?this.params.enquiryAndQuotedId:this.params.id,module:"quotedRecords"===this.params.module?"clue":this.params.module}).then(function(e){t.showLoading=!1,"quotedRecords"===t.params.module&&(e.quotedRecordDetailsList=e.quotedRecordDetailsList.filter(function(e){return e.id===t.params.id})),t.data=e}).catch(function(e){t.showLoading=!1,t.showError=!0,t.errorMessage=e.message})},onSuccess:function(){this.params.onSuccess&&this.params.onSuccess(),this.fetchData()}},mounted:function(){this.fetchData()},activated:function(){s.a.setRight()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("yi-container",{attrs:{"show-loading":t.showLoading,"hide-btn":!0,"show-error":t.showError,"error-message":t.errorMessage}},[a("cube-scroll",[t.data?a("div",{staticClass:"header-contain"},[t.data.createByAvatar?a("yi-image",{staticClass:"icon",attrs:{src:t.data.createByAvatar}}):a("span",{staticClass:"img-name"},[t._v(t._s(t.data.createByName))]),t._v(" "),a("div",{staticClass:"header-name"},[t._v("询价人："+t._s(t.data.createByName))]),t._v(" "),a("div",[t._v(t._s(t.data.createTime.split(" ")[0]))])],1):t._e(),t._v(" "),a("div",{staticClass:"section-text"},[t._v("询价信息")]),t._v(" "),a("ListBox",{attrs:{form:t.infoValue}}),t._v(" "),a("div",{staticClass:"section-text"},[t._v("报价信息")]),t._v(" "),t.data?a("QuotedRecordTab",{attrs:{onSuccess:t.onSuccess,type:"detail","all-data":t.data.quotedRecordDetailsList}}):t._e()],1)],1)},staticRenderFns:[]};var u=a("VU/8")(l,d,!1,function(t){a("RIhZ")},"data-v-4e3009fa",null);e.default=u.exports},RIhZ:function(t,e){},ssPP:function(t,e,a){"use strict";var i=a("mvHQ"),n=a.n(i),s=a("Xxa5"),c=a.n(s),r=a("exGp"),o=a.n(r),l=a("Dd8w"),d=a.n(l),u=a("dwHJ"),m=a("AYFL"),h=a("t5DY"),v={components:{CommonTab:u.a,ListBox:m.a},name:"QuotedRecordTab",props:{allData:[Object,Array],onSuccess:Function,type:{type:String,default:"tab"}},data:function(){return{id:this.$route.params.id,module:this.$route.params.module,data:[],edit:!1,selectedContent:[-1,-1]}},mounted:function(){"tab"===this.type&&this.fetchData()},computed:{showCancelButton:function(){return 0!==this.listData.length&&this.edit},showOfferButton:function(){var t=0;return this.listData.forEach(function(e){return t+=e.data.length}),t>0},btnDisabled:function(){return this.edit&&-1===this.selectedContent[0]},isEditEnabled:function(){return-1===this.listData.findIndex(function(t){return 1===t.status.code})&&"quotedPrices"!==this.module&&"quotedRecords"!==this.module},listData:function(){return("tab"===this.type?this.data:this.allData).map(function(t){return d()({title:"报价人："+t.createByName,date:t.createTime,data:t.quotedPriceMsgList.map(function(t){var e=t.resourceLocation,a=t.insuranceType,i=t.capitalCost,n=t.deliveryTime,s=t.invoiceType,c=t.procedureTracks,r=t.productionTime,o=t.quotedPrice,l=t.invoicePrice,d=t.resourceArea,u=t.remarks,m=t.trafficPrice,h=t.carSourceType;return[{title:"车源所在地",value:e&&e.name},{title:"车辆报价",value:o,type:"money"},{title:"物流成本",value:m,type:"money"},{title:"资金成本",value:i,type:"money"},{title:"手续时间",value:c+"个工作日"},{title:"开票金额",value:l,type:"money"},{title:"车源位置",value:d},{title:"车源类型",value:h&&h.name},{title:"生产日期",value:r},{title:"提车时间",value:n?n+"天":""},{title:"保险要求",value:a&&a.name},{title:"发票类型",value:s&&s.name},{title:"其他备注",value:u}]})},t)})}},methods:{fetchData:function(){var t=this;return o()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(h.s)(t.id);case 3:t.data=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t.data=[];case 9:case"end":return e.stop()}},e,t,[[0,6]])}))()},handleOfferClick:function(){var t=this;return o()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.edit){e.next=4;break}t.edit=!0,e.next=9;break;case 4:return e.next=6,Object(h.a)({enquiryId:t.id,quotedMsgId:t.listData[t.selectedContent[0]].quotedPriceMsgList[t.selectedContent[1]].id});case 6:t.fetchData(),t.allData.fetchData&&t.allData.fetchData(),t.onSuccess&&t.onSuccess();case 9:case"end":return e.stop()}},e,t)}))()},handleCancelClick:function(){this.edit=!1},onGetDetail:function(t){this.$RouteUtil.offerDetail(t)},showAccept:function(t){return 1===t.code},handleContentClick:function(t,e){this.isSelected(t,e)?this.selectedContent=[-1,-1]:this.selectedContent=[t,e]},isSelected:function(t,e){return n()(this.selectedContent)===n()([t,e])}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("common-tab",{attrs:{"empty-text":"暂无报价记录","empty-icon":t.$images.base.img_record,data:t.listData},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item,n=e.index;return a("div",{},[a("div",{staticClass:"cell-title"},[t._v(t._s(i.carName))]),t._v(" "),a("div",{staticClass:"cell-contain"},[0!==i.data.length?t._l(i.data,function(e,s){return a("yi-touch",{key:s,staticClass:"record-contain",attrs:{disabled:!t.edit},on:{click:function(e){t.handleContentClick(n,s)}}},[a("div",{staticClass:"title"},[t._v("报价内容-"+t._s(s+1)+"\n              "),t.showAccept(i.quotedPriceMsgList[s].status)?a("div",{staticClass:"tag"},[t._v("已采纳")]):t.edit?a("yi-image",{staticClass:"img-check",attrs:{src:t.isSelected(n,s)?t.$images.base.ic_check_selected:t.$images.base.ic_check_normal}}):t._e()],1),t._v(" "),a("list-box",{attrs:{"hide-margin-left":!0,form:e,"more-text":"报价详情","more-index":4,"show-more":!0}})],1)}):a("div",{staticClass:"record-contain"},[a("div",{staticClass:"record-top"},[a("div",{staticClass:"small-circle"}),t._v(" "),a("div",{staticClass:"name text"},[t._v("暂无报价")])])])],2)])}}])}),t._v(" "),t.isEditEnabled?a("div",{staticStyle:{display:"flex",width:"100%"}},[t.showCancelButton?a("yi-btn-box",{staticClass:"btn cancel",attrs:{name:"取消报价"},on:{onBtnClick:t.handleCancelClick}}):t._e(),t._v(" "),t.showOfferButton?a("yi-btn-box",{class:{btn:!0,"btn-disabled":t.btnDisabled},attrs:{disabled:t.btnDisabled,name:"采纳报价"},on:{onBtnClick:t.handleOfferClick}}):t._e()],1):t._e()],1)},staticRenderFns:[]};var p=a("VU/8")(v,f,!1,function(t){a("x3XW")},"data-v-62729524",null);e.a=p.exports},x3XW:function(t,e){}});
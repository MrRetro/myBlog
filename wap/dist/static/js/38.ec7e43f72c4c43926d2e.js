webpackJsonp([38],{I4gh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Gtft"),o=a("yelY"),l=a("heE5"),s={name:"CommonPlanAll",extends:a("OPJW").a,created:function(){var t=this;this.$nextTick(function(){var e=new Date;t.onSelDate(Object(l.b)(e.getFullYear(),e.getMonth()+1,e.getDate())),Object(o.g)({test:"test",type:t.params.type}).then(function(e){console.log(e),e.planForMonthList&&(t.planDate=e.planForMonthList.filter(function(t){return t.count>0}).map(function(t){return t.date.replace(/-/g,"/")}),console.log(e,"----\x3e"),t.tableData.body=e.planCollectList.map(function(t){return{id:t.userId,tr:[{value:t.userName},{value:t.planTotalCount},{value:t.planFinishedCount},{value:t.performRatio}]}}),console.log(t.tableData,"<----\x3e"))}).catch(function(t){return console.log(t,"=>err")})})},activated:function(){var t=this,e=[{id:"1",text:"今天",url:"http://images.itsmycar.cn/button_today.png"}];("clue"===this.params.type&&this.$store.state.user.userAuths["wap-crm-clue-plan-auth"]||"agent"===this.params.type&&this.$store.state.user.userAuths["wap-agents-add-auth"])&&e.push({id:"2",text:"新建"}),n.a.setMenu({items:e,onSuccess:function(e){console.log(e),"1"===e.id?t.selToDay():"2"===e.id&&t.$RouteUtil.commonPlanAdd({type:t.type,module:t.module,BACK_ACTION:{path:t.ROUTE_PATH}})}})},data:function(){return{id:this.$route.params.id,type:this.$route.params.type,module:this.$route.params.module,selDate:"",planDate:[],tableData:{title:"下属员工跟进计划",head:[{name:"姓名"},{name:"计划数量"},{name:"完成数量"},{name:"完成比例"}],body:[]}}},methods:{onSelDate:function(t){var e=this;console.log("当前选中日期："+t),this.selDate=t;var a=t.split("/"),n=this.params.type,l=a[0],s=a[1],i=a[2];console.log(n),console.log(l),console.log(s),console.log(i),console.log(1),Object(o.k)({type:this.params.type,year:l,month:s,day:i,pageNum:1}).then(function(t){console.log(t,"-------1"),e.planDate=t.planForMonthList.filter(function(t){return t.count>0}).map(function(t){return t.date.replace(/-/g,"/")});var a=t.planCollectList,n=[];a&&a.map(function(t){return n.push({id:t.userId,tr:[{value:t.userName},{value:t.planTotalCount},{value:t.planFinishedCount},{value:t.performRatio}]}),!1}),n.length>0?e.tableData.body=n:e.tableData.body=null,console.log(e.tableData)}).catch(function(t){return console.log(t,"-------2")})},selToDay:function(){this.$refs.calendar.handleSelToday()},onMonth:function(t){var e=this;console.log(t,"123"),Object(o.i)({month:t,type:this.params.type}).then(function(t){console.log(t,"666"),e.planDate=t.filter(function(t){return t.count>0}).map(function(t){return t.date.replace(/-/g,"/")})}).catch(function(t){return console.log(t)})},onSelectById:function(t){var e=this.selDate;this.$RouteUtil.commonPlanList({type:this.type,module:this.module,id:t,date:e})}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"statistcs-box app-init"},[e("cube-scroll",[e("yi-calendar",{ref:"calendar",attrs:{special:this.planDate},on:{onSelDate:this.onSelDate,onMonth:this.onMonth}}),this._v(" "),e("p",{staticClass:"space-line"}),this._v(" "),e("yi-table",{attrs:{form:this.tableData},on:{onSelectById:this.onSelectById}})],1)],1)},staticRenderFns:[]};var r=a("VU/8")(s,i,!1,function(t){a("jV2b")},"data-v-9b07fe6a",null);e.default=r.exports},jV2b:function(t,e){}});
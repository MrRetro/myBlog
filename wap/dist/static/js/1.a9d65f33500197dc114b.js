webpackJsonp([1],{"tDG+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("//Fk"),n=a.n(r),i=a("mvHQ"),o=a.n(i),l=a("ViqS"),c=a.n(l),s=a("1N4U"),u=a("1CjK"),d=a("3r8y"),m=a("Gtft"),p=a("N6PA"),f=a("6D10"),v=a("heE5"),y={name:"inquiry-add",extends:d.a,created:function(){var e=this;this.$nextTick(function(){e.params=e.$route.params;var t=e.params;console.log(t,"==>type"),t&&"edit"===t.type?(e.id=t.id,e.form.type="edit"):(e.id=t.id,e.form.type="add"),"add"===e.form.type?e.getPage({}):Object(s.g)(e.id).then(function(t){e.id=t.id,e.edit=t,e.getPage(t)}).catch(function(e){console.log(e)})})},activated:function(){m.a.setRight()},computed:{btnName:function(){return"edit"===this.params.type?"编辑询价":"发起询价"}},data:function(){return{initData:null,clueId:"",id:"",form:{type:"add",data:[]},edit:null}},methods:{isEdit:function(){return this.initData!==o()(this.form)},onBtnClick:function(){var e=this;console.log(this.form);var t=[];this.$refs.va.forEach(function(e){e.rules&&!Object(f.j)(e)&&t.push(e.changeV())}),console.log(t,"--------"),n.a.all(t).then(function(t){if(t.every(function(e){return e})){console.log(e.form,"校验成功并提交数据");var a={};e.form.data.forEach(function(e){if("group"!==e.attr){var t="";t=e.value?e.value:0===e.value?0:e.text,console.log(t,"item"),"appearance"!==e.attr&&"interior"!==e.attr||(t="无"===t?null:t&&o()(t)||""),"estimateObtainTime"===e.attr&&e.text&&(t=Object(v.a)(e.text)),"billingTime"===e.attr&&e.text&&(t=Object(v.a)(e.text)),a[e.attr]=t,"areaId"===e.attr&&(a[e.attr]=""+a[e.attr])}}),a.clueId=e.$ChangeType.xToType(a.clueId,"string"),a.customerType=e.$ChangeType.xToType(a.customerType,"number"),a.areaId=e.$ChangeType.xToType(a.areaId,"string"),a.number=e.$ChangeType.xToType(a.number,"number"),a.estimateObtainTime=e.$ChangeType.xToType(a.estimateObtainTime,"string"),a.billingDemand=e.$ChangeType.xToType(a.billingDemand,"string"),a.billingTime=e.$ChangeType.xToType(a.billingTime,"string"),a.demand=e.$ChangeType.xToType(a.demand,"string"),delete a.clueLevel,delete a.vehicleModelId,delete a.appearance,delete a.interior,delete a.guidancePrice,delete a.shoppingWay,"add"===e.form.type?(console.log(a,"==>add"),Object(s.a)(a).then(function(t){console.log(e.params,"==>params"),console.log(t),t&&(e.params.onSuccess&&e.params.onSuccess(),e.$RouteUtil.commonDetail({module:"enquiryPrices",id:t,BACK_ACTION:e.params.BACK_ACTION}))}).catch(function(e){return console.log(e)})):"edit"===e.form.type&&(a.id=e.id,Object(s.d)(a).then(function(){e.params.onSuccess&&e.params.onSuccess(),e.$router.go(-1)}).catch(function(e){return console.log(e)}))}})},onCarModel:function(e,t){var a=this;console.log(e,"data");var r=e.data.innerColors,n=e.data.outerColors;this.form.data.forEach(function(e,i){"appearance"===e.attr&&(t||(a.form.data[i].text=null,a.form.data[i].value=null),n?(a.form.data[i].selData=n,a.form.data[i].disable=!1,a.form.data[i].text=null):(a.form.data[i].selData=null,a.form.data[i].disable=!0,a.form.data[i].text="无")),"interior"===e.attr&&(t||(a.form.data[i].text=null,a.form.data[i].value=null),r?(a.form.data[i].selData=r,a.form.data[i].disable=!1,a.form.data[i].text=null):(a.form.data[i].selData=null,a.form.data[i].disable=!0,a.form.data[i].text="无"))}),t&&(this.initData=o()(this.form))},selClue:function(e){var t=this;console.log(e," 123 "),this.form.data.forEach(function(a,r){if("clueId"===a.attr&&(t.form.data[r].text=e.clueNo||e.id,t.form.data[r].value=e.id),"clueLevel"===a.attr&&(t.form.data[r].text=e.intentionGrade.name,t.form.data[r].value=e.intentionGrade.code),"vehicleModelId"===a.attr&&(t.form.data[r].text=e.carName,t.form.data[r].value=e.vehicleModelId),"appearance"===a.attr){var n=null;try{n=JSON.parse(e.appearance)}catch(e){n=null}t.form.data[r].text=n&&n.name||null,t.form.data[r].value=n||null}if("interior"===a.attr){var i=null,o=null;try{o=(i=JSON.parse(e.interior))&&i.colors&&i.colors[0].name,i.colors&&i.colors[1]&&(o+="/"+i.colors[1].name)}catch(e){i=null}t.form.data[r].text=o||null,t.form.data[r].value=i||null}"indicativePrice"===a.attr&&(t.form.data[r].text=e.indicativePrice&&c()(1e4*e.indicativePrice).format("0,0.00"),t.form.data[r].value=e.indicativePrice&&c()(1e4*e.indicativePrice).format("0,0.00")),"shoppingWay"===a.attr&&(t.form.data[r].text=e.shoppingWay.name,t.form.data[r].value=e.shoppingWay.code)})},getPage:function(e){var t=this;console.log(e,"edit-----\x3e>>>>");var a=this.menu,r=a.clueAdditionalConfiguration,n=a.clueIntentionType,i=a.clueIntentionGrade,l=a.clueShoppingWay,d=a.gender,m=a.customerOrigin,y=a.enquiryCustomerType;Object(s.e)().then(function(a){console.log(a,"==>module");var s=[];a.forEach(function(e){"create-inquiry"===e.code&&"add"===t.form.type&&(s=e.fields),"edit-inquiry"===e.code&&"edit"===t.form.type&&(s=e.fields)}),s.sort(function(e,t){return e.sort-t.sort});var h=[];s.forEach(function(a){var o={attr:a.attr,type:u.a[a.configsObj.type],title:a.name,text:null,value:null,placeholder:a.configsObj.placeholder,indent:!0,columnWidth:a.columnWidth,selData:{source:[],selectedKey:""}};if("clueId"===a.attr&&(o.params=t.params,"clues"===t.params.module&&(o.disable=!0),"enquiryPrices"===t.params.module&&(o.type="selClueOfAll")),"clueLevel"===o.attr&&(o.disable=!0),"vehicleModelId"===o.attr&&(o.singleChoose=!0,o.disable=!0),"appearance"===o.attr&&(o.disable=!0),"interior"===o.attr&&(o.disable=!0),"indicativePrice"===o.attr&&(o.disable=!0),"shoppingWay"===o.attr&&(o.disable=!0),e[o.attr]){if(o.value=e[o.attr],o.text=e[o.attr],console.log(o.attr,"attr"),"clueId"===o.attr&&(o.text=e.clueNo,o.value=e[o.attr]),"clueLevel"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"vehicleModelId"===o.attr&&(o.text=e.vehicleModel,o.value=e[o.attr]),"appearance"===o.attr&&(console.log(e[o.attr],"dddddd"),o.text=e[o.attr]&&JSON.parse(e[o.attr])&&JSON.parse(e[o.attr]).name,o.value=e[o.attr]?JSON.parse(e[o.attr]):null),"interior"===o.attr){var s=e[o.attr]&&JSON.parse(e[o.attr]).colors&&JSON.parse(e[o.attr]).colors[0].name;JSON.parse(e[o.attr]).colors&&JSON.parse(e[o.attr]).colors[1]&&(s+="/"+JSON.parse(e[o.attr]).colors[1].name),o.text=s,o.value=e[o.attr]?JSON.parse(e[o.attr]):null}"indicativePrice"===a.attr&&(o.text=e.indicativePrice&&c()(1e4*e.indicativePrice).format("0,0.00"),o.value=e.indicativePrice&&c()(1e4*e.indicativePrice).format("0,0.00")),"shoppingWay"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"customerType"===o.attr&&(o.text=e[o.attr].name,o.value=e[o.attr].code),"areaId"===o.attr&&(o.text=e.area,o.value=e[o.attr]),"number"===o.attr&&(o.text=e.number,o.value=e[o.attr]),"capitalCost"===o.attr&&(o.text=e.capitalCost,o.value=e[o.attr]),"estimateObtainTime"===o.attr&&(o.text=e[o.attr]&&Object(v.d)(e[o.attr]),o.value=e[o.attr]&&Object(v.d)(e[o.attr])),"billingDemand"===o.attr&&(o.text=e[o.attr],o.value=e[o.attr]),"billingTime"===o.attr&&(o.text=e[o.attr]&&Object(v.d)(e[o.attr]),o.value=e[o.attr]&&Object(v.d)(e[o.attr])),"demand"===o.attr&&(o.text=Object(f.d)(e[o.attr]),o.value=Object(f.d)(e[o.attr]))}var b=!1;a.rulesObj&&a.rulesObj.forEach(function(e){"required"===e.type&&(b=!0)});var g=Object(p.a)(a);switch(b&&(o.required=b),g&&(o.rules=g),a.attr){case"vehicleModelId":o.selData.source=r.map(function(e){return{key:e.name,value:e.code}});break;case"intentionType":o.selData.source=n.map(function(e){return{key:e.name,value:e.code}});break;case"clueLevel":o.selData.source=i.map(function(e){return{key:e.name,value:e.code}});break;case"intentionGrade":o.selData.source=n.map(function(e){return{key:e.name,value:e.code}});break;case"shoppingWay":o.selData.source=l.map(function(e){return{key:e.name,value:e.code}});break;case"appearance":case"interior":o.selData=null;break;case"gender":o.selData.source=d.map(function(e){return{key:e.name,value:e.code}});break;case"origin":o.selData.source=m.map(function(e){return{key:e.name,value:e.code}});break;case"customerType":o.selData.source=y.map(function(e){return{key:e.name,value:e.code}})}h.push(o)}),t.form.data=h,"clues"===t.params.module&&t.selClue(t.params.params),t.initData=o()(t.form)}).catch(function(e){console.log(e,"==============================>err")})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"input-box2"},[a("cube-scroll",[a("div",{staticClass:"content"},[e._l(e.form.data,function(t,r){return["customerId"===t.attr?a("div",{key:"index"+r,staticClass:"id-box"},e._l(e.form.info,function(t,r){return a("div",{key:"index2"+r,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:"info",refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth,disable:!0},on:{"update:value":function(a){e.$set(t,"value",a)}},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item1.text"}},"yi-input",t,!1))],1)})):"groupHeader"===t.type?a("div",{key:"index"+r,staticClass:"section-title section-margin-top"},[e._v("\n            "+e._s(t.title)+"\n          ")]):a("div",{key:"index"+r,staticClass:"in-box",class:{self:50===t.columnWidth}},[a("yi-input",e._b({ref:"va",refInFor:!0,attrs:{value:t.value,indent:!0,selData:t.selData||null,clearMR:50===t.columnWidth},on:{"update:value":function(a){e.$set(t,"value",a)},onCarModel:e.onCarModel,selClue:e.selClue},model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}},"yi-input",t,!1))],1)]}),e._v(" "),a("div",{staticClass:"space-box"})],2)])],1),e._v(" "),a("yi-btn-box",{attrs:{name:e.btnName},on:{onBtnClick:e.onBtnClick}})],1)},staticRenderFns:[]};var b=a("VU/8")(y,h,!1,function(e){a("tzcd")},"data-v-41947c26",null);t.default=b.exports},tzcd:function(e,t){}});
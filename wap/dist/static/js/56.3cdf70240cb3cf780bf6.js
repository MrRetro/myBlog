webpackJsonp([56],{CGGP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),o=a("exGp"),s=a.n(o),l=a("mvHQ"),i=a.n(l),u=a("pFYg"),c=a.n(u),d=a("//Fk"),f=a.n(d),v=a("ViqS"),p=a.n(v),m=a("FWz8"),h=a("1CjK"),x=a("3r8y"),b=a("Gtft"),y=a("N6PA"),g=a("6D10"),C={name:"order-finish-car",extends:x.a,created:function(){var t=this;this.$nextTick(function(){t.params=t.$route.params,console.log(t.params,"-----------\x3e0203");var e=t.params;e&&e.id&&(t.id=e.id),t.getPage({})})},activated:function(){b.a.setRight()},computed:{btnName:function(){return"完成提车"}},data:function(){return{initData:null,params:this.$route.params,clueId:"",id:"",isOnline:!1,orderType:null,form:{type:"add",info:[{attr:"name",type:"text",title:"客户名称",text:null,value:null,placeholder:"请选择客户名称1",required:!1,indent:!1},{attr:"mobile",type:"text",title:"联系电话",text:null,value:null,placeholder:"客户联系电话",required:!1,indent:!1},{attr:"gender",type:"text",title:"性别",text:null,value:null,placeholder:"请选择性别",required:!1,indent:!1}],data:[]},edit:null}},methods:{isEdit:function(){return this.$store.dispatch("order/getData4",this.form.data),!1},onBtnClick:function(){var t=this;console.log(this.form);var e=[];this.$refs.va.forEach(function(t){t.rules&&!Object(g.j)(t)&&e.push(t.changeV())}),console.log(e,"--------"),f.a.all(e).then(function(e){var a=e.every(function(t){return t});if(a&&a){var r={};t.form.data.filter(function(t){return"group"!==t.attr&&"departureAddress"!==t.attr&&"arrivalsAddress"!==t.attr}).map(function(t){var e="";e=t.value?t.value:0===t.value?0:t.text,r[t.attr]=e});var n=r.vin,o=r.carInspectionPhoto;o=o.map(function(t){return t.url}),Object(m.d)({orderId:t.id,vin:n,carInspectionPhoto:o}).then(function(e){console.log(e),t.params.onSuccess&&t.params.onSuccess(),t.$RouteUtil.back()}).catch(function(t){console.log(t)})}return!1})},onGetName:function(t){this.$refs.va.forEach(function(e){console.log(e),"name"===e.$attrs.attr&&e.setText(t)})},onChangeMoney:function(t){var e=this;console.log(t,"obj");var a=0,r=0;if(("totalAmount"===t.type||"deposit"===t.type)&&(console.log("要联动了"),this.form.data.forEach(function(t){"totalAmount"===t.attr&&t.value&&(a=p()(t.value).format("0.00")),"deposit"===t.attr&&t.value&&(r=p()(t.value).format("0.00"))}),a&&r)){var n=p()(a-r).format("0,0.00");this.form.data.forEach(function(t,a){"balance"===t.attr&&(e.form.data[a].text=n,e.form.data[a].value=p()(n).format("0.00"))})}},onSelect:function(t,e){var a=this;if("deliveryPlaceType"===t.type)switch(t.value=this.$ChangeType.xToType(t.value,"string"),console.log(t.value),console.log(c()(t.value),"pppppppppp"),t.value){case"0":this.form.data.forEach(function(t,r){"deliveryPlace"===t.attr&&(e||(a.form.data[r].text=a.params.storeAddress,a.form.data[r].value=a.params.storeAddress),a.form.data[r].disable=!0)});break;case"1":this.form.data.forEach(function(r,n){"deliveryPlace"===r.attr&&(e||(a.form.data[n].text=t.address||"",a.form.data[n].value=t.address||""),a.form.data[n].disable=!1)})}},onCarModel:function(t,e){var a=this;console.log(t,"data");var r=t.data.innerColors,n=t.data.outerColors;this.form.data.forEach(function(t,o){"appearance"===t.attr&&(e||(a.form.data[o].text=null,a.form.data[o].value=null),n?(a.form.data[o].selData=n,a.form.data[o].disable=!1,a.form.data[o].text=null):(a.form.data[o].selData=null,a.form.data[o].disable=!0,a.form.data[o].text="无")),"interior"===t.attr&&(e||(a.form.data[o].text=null,a.form.data[o].value=null),r?(a.form.data[o].selData=r,a.form.data[o].disable=!1,a.form.data[o].text=null):(a.form.data[o].selData=null,a.form.data[o].disable=!0,a.form.data[o].text="无"))}),e&&(this.initData=i()(this.form))},getAgent:function(t){var e=this;return s()(n.a.mark(function a(){var r,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=JSON.parse(i()(t)),o=[],a.prev=2,!e.$store.state.order.storeId){a.next=14;break}return a.next=6,Object(m.s)({storeId:e.$store.state.order.storeId,orderType:e.$store.state.order.orderType,userId:e.$store.state.order.customerNo});case 6:o=a.sent,r.text=o&&o[0]&&o[0].name||"",r.value=o&&o[0]&&o[0].id||"",r.disable=!0,r.type="text",r.selData={source:[]},a.next=22;break;case 14:return a.next=16,Object(m.r)({id:e.$store.state.user.id});case 16:o=a.sent,r.text=o&&o[0]&&o[0].name||"",r.value=o&&o[0]&&o[0].id||"",r.disable=!1,r.type="select",r.selData={source:o&&o.map(function(t){return{key:t.name,value:t.id}})};case 22:a.next=27;break;case 24:a.prev=24,a.t0=a.catch(2),console.log("报错了==>",a.t0);case 27:return console.log(r),a.abrupt("return",r);case 29:case"end":return a.stop()}},a,e,[[2,24]])}))()},getAllAcount:function(){var t=0,e=1;return this.params.data1.forEach(function(t){if(console.log("==>item1",t),"amount"===t.attr){try{t.value=parseInt(t.value)}catch(e){t.value=1}e=t.value}}),this.params.data3.forEach(function(e){if("insuranceExpensesType"!==e.attr&&"insuranceCompany"!==e.attr&&"purchaseTaxType"!==e.attr&&"additionalProvisions"!==e.attr&&"group"!==e.attr){try{e.value=parseFloat(item.value)}catch(t){}t=parseFloat(t)+parseFloat(e.value)}}),t*e},getPage:function(){var t=this;return s()(n.a.mark(function e(){var a,r,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.j)({orderId:t.id});case 2:a=e.sent,r=a.departureAddress,o=a.arrivalsAddress,Object(m.f)().then(function(e){console.log(e,"=========================>success2");var a=[];e.forEach(function(t){a=t.fields}),a.sort(function(t,e){return t.sort-e.sort});var n=[];a.forEach(function(t){var e={attr:t.attr,type:h.a[t.configsObj.type],title:t.name,text:null,value:null,placeholder:t.configsObj.placeholder,indent:!0,columnWidth:t.columnWidth,selData:{source:[],selectedKey:"下单客户1"}};"departureAddress"===t.attr&&(e.text=r,e.value=r,e.disable=!0),"arrivalsAddress"===t.attr&&(e.text=o,e.value=o,e.disable=!0);var a=!1;t.rulesObj&&t.rulesObj.forEach(function(t){"required"===t.type&&(a=!0)});var s=Object(y.a)(t);a&&(e.required=a),s&&(e.rules=s),n.push(e)}),t.form.data=n,console.log(t.form.data,"----------\x3e>>>>>>>>>"),t.initData=i()(t.form)}).catch(function(t){console.log(t,"==============================>err")});case 5:case"end":return e.stop()}},e,t)}))()}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"input-box2"},[a("cube-scroll",[a("div",{staticClass:"content"},[t._l(t.form.data,function(e,r){return["customerId"===e.attr?a("div",{key:"index"+r,staticClass:"id-box"},t._l(t.form.info,function(e,r){return a("div",{key:"index2"+r,staticClass:"in-box",class:{self:50===e.columnWidth}},[a("yi-input",t._b({ref:"info",refInFor:!0,attrs:{value:e.value,indent:!0,selData:e.selData||null,clearMR:50===e.columnWidth,disable:!0},on:{"update:value":function(a){t.$set(e,"value",a)}},model:{value:e.text,callback:function(a){t.$set(e,"text",a)},expression:"item1.text"}},"yi-input",e,!1))],1)})):"groupHeader"===e.type?a("div",{key:"index"+r,staticClass:"section-title section-margin-top"},[t._v("\n            "+t._s(e.title)+"\n          ")]):a("div",{key:"index"+r,staticClass:"in-box",class:{self:50===e.columnWidth}},[a("yi-input",t._b({ref:"va",refInFor:!0,class:{hide:"orderNo"===e.attr},attrs:{value:e.value,indent:!0,selData:e.selData||null,clearMR:50===e.columnWidth},on:{"update:value":function(a){t.$set(e,"value",a)},onCarModel:t.onCarModel,onGetName:t.onGetName,onSelect:t.onSelect,onChangeMoney:t.onChangeMoney},model:{value:e.text,callback:function(a){t.$set(e,"text",a)},expression:"item.text"}},"yi-input",e,!1))],1)]}),t._v(" "),a("div",{staticClass:"space-box"})],2)])],1),t._v(" "),a("yi-btn-box",{attrs:{name:t.btnName},on:{onBtnClick:t.onBtnClick}})],1)},staticRenderFns:[]};var $=a("VU/8")(C,k,!1,function(t){a("xNu7")},"data-v-5a53ae72",null);e.default=$.exports},xNu7:function(t,e){}});